# –ü–∞—Ä—Å–µ—Ä—ã –¥–ª—è Povar.ru

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

–°–æ–∑–¥–∞–Ω—ã 2 –ø–∞—Ä—Å–µ—Ä–∞ –¥–ª—è —Å–±–æ—Ä–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤ —Å Povar.ru:

### 1Ô∏è‚É£ **RecipeListParserService** - —Å–±–æ—Ä—â–∏–∫ URL —Ä–µ—Ü–µ–ø—Ç–æ–≤
- **–§–∞–π–ª**: `app/Services/RecipeListParserService.php`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ü–∞—Ä—Å–∏–Ω–≥ —Å–ø–∏—Å–∫–æ–≤ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π Povar.ru
  - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º (1, 2, 3...)
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏**:
- `meat` - –ë–ª—é–¥–∞ –∏–∑ –º—è—Å–∞ (https://povar.ru/list/meat/)
- `fish` - –ë–ª—é–¥–∞ –∏–∑ —Ä—ã–±—ã (https://povar.ru/list/fish/)
- `ptica` - –ë–ª—é–¥–∞ –∏–∑ –ø—Ç–∏—Ü—ã (https://povar.ru/list/ptica/)
- `vegies` - –ë–ª—é–¥–∞ –∏–∑ –æ–≤–æ—â–µ–π (https://povar.ru/list/vegies/)
- `salad` - –°–∞–ª–∞—Ç—ã (https://povar.ru/list/salad/)
- `soup` - –°—É–ø—ã (https://povar.ru/list/soup/)
- `vypechka` - –í—ã–ø–µ—á–∫–∞ (https://povar.ru/list/vypechka/)
- `dessert` - –î–µ—Å–µ—Ä—Ç—ã (https://povar.ru/list/dessert/)

### 2Ô∏è‚É£ **RecipeParserService** - –ø–∞—Ä—Å–µ—Ä –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- **–§–∞–π–ª**: `app/Services/RecipeParserService.php`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ü–∞—Ä—Å–∏–Ω–≥ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ—Ü–µ–ø—Ç–µ
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç DOMXPath –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
  - –°–∫–∞—á–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  - –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ü–∞—Ä—Å—è—Ç—Å—è –ø–æ–ª—è**:
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ (title)
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ (description) 
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (image_path)
- ‚úÖ –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã (ingredients) - –º–∞—Å—Å–∏–≤ —Å name, quantity, measure
- ‚úÖ –®–∞–≥–∏ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è (steps) - –º–∞—Å—Å–∏–≤ —Å step_number, description, image
- ‚úÖ –í—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è (total_time)
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ü–∏–π (servings)
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ (rating)
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ü–µ–Ω–æ–∫ (rating_count)
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–∏–≤—è–∑–∫–∞)
- ‚úÖ SEO: meta_title, meta_description, meta_keywords, canonical_url, og_image
- ‚ùå –ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å (nutrition) - –Ω–µ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –Ω–∞ Povar.ru
- ‚ùå –ü—Ä–æ—Å–º–æ—Ç—Ä—ã, –ª–∞–π–∫–∏ - –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–∞ Povar.ru

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –°–±–æ—Ä URL —Ä–µ—Ü–µ–ø—Ç–æ–≤

**–°–æ–±—Ä–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç—ã –∏–∑ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:**
```bash
php artisan recipes:collect-urls meat --count=50
```

**–°–æ–±—Ä–∞—Ç—å –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–º—è—Å–æ", –Ω–∞—á–∏–Ω–∞—è —Å–æ 2-–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
```bash
php artisan recipes:collect-urls meat --count=50 --start-page=2
```

**–°–æ–±—Ä–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç—ã –∏–∑ –í–°–ï–• –∫–∞—Ç–µ–≥–æ—Ä–∏–π:**
```bash
php artisan recipes:collect-urls --count=30
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏

–ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ (–∫–æ–º–∞–Ω–¥–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å):
```bash
php artisan recipes:process-queue
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –°–æ–±—Ä–∞—Ç—å 100 —Ä–µ—Ü–µ–ø—Ç–æ–≤ —Å–∞–ª–∞—Ç–æ–≤
```bash
php artisan recipes:collect-urls salad --count=100
```

### –ü—Ä–∏–º–µ—Ä 2: –°–æ–±—Ä–∞—Ç—å –ø–æ 20 —Ä–µ—Ü–µ–ø—Ç–æ–≤ –∏–∑ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```bash
php artisan recipes:collect-urls --count=20
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–±–æ—Ä–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
```bash
# 1. –°–æ–±–∏—Ä–∞–µ–º URL
php artisan recipes:collect-urls meat --count=50

# 2. –ü–∞—Ä—Å–∏–º —Ä–µ—Ü–µ–ø—Ç—ã
php artisan recipes:process-queue
```

---

## üîç –°—Ç—Ä—É–∫—Ç—É—Ä–∞ HTML Povar.ru

### –°–ø–∏—Å–æ–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤
```html
<div class="recipe">
  <a href="/recipes/salat_parij-73708.html" class="listRecipieTitle">
    –°–∞–ª–∞—Ç –ü–∞—Ä–∏–∂
  </a>
</div>
```

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
```html
<h1 class="detailed fn" itemprop="name">–î–æ–º–∞—à–Ω—è—è –ù—É—Ç–µ–ª–ª–∞</h1>

<img itemprop="image" src="https://img.povar.ru/main/...JPG">

<meta itemprop="totalTime" content="PT20M">
<span itemprop="recipeYield">6</span>

<li itemprop="recipeIngredient">
  <span class="name">–§—É–Ω–¥—É–∫</span> - 
  <span class="value">100</span>
  <span class="type"> –≥—Ä.</span>
</li>

<div class="instruction">
  <p itemprop="text">–®–∞–≥ 1. ...</p>
  <img src="...">
</div>

<span itemprop="ratingValue">5.0</span>
<span itemprop="ratingCount">234</span>
```

---

## üîÑ –û—Ç–ª–∏—á–∏—è –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ 1000.menu

| –ü–∞—Ä–∞–º–µ—Ç—Ä | 1000.menu | Povar.ru |
|----------|-----------|----------|
| **URL —Å–ø–∏—Å–∫–æ–≤** | `/cooking/all-new?offset=0` | `/list/meat/`, `/list/meat/2/` |
| **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** | Offset (0, 20, 40...) | –°—Ç—Ä–∞–Ω–∏—Ü—ã (1, 2, 3...) |
| **–°–µ–ª–µ–∫—Ç–æ—Ä —Å–ø–∏—Å–∫–∞** | Regex `/cooking/\d+` | XPath `//a[@class="listRecipieTitle"]` |
| **–°–µ–ª–µ–∫—Ç–æ—Ä —Ä–µ—Ü–µ–ø—Ç–∞** | Regex + class | DOMXPath + itemprop |
| **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏** | Breadcrumbs | `itemprop="recipeCategory"` |
| **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** | og:image | `itemprop="image"` |

---

## üìù –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è

–°—Ç–∞—Ä—ã–π –ø–∞—Ä—Å–µ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤:
- `app/Services/RecipeParserService.php.backup`

–î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:
```bash
Copy-Item app/Services/RecipeParserService.php.backup app/Services/RecipeParserService.php
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Cron (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏)

–í `PRODUCTION_CRONTAB.txt` –æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å–±–æ—Ä–∞ URL:

```cron
# –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç - —Å–±–æ—Ä URL –∏–∑ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
*/15 * * * * cd /path/to/project && php artisan recipes:collect-urls --count=30 >> /dev/null 2>&1

# –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏
*/30 * * * * cd /path/to/project && php artisan recipes:process-queue >> /dev/null 2>&1
```

---

## üêõ –õ–æ–≥–∏

–í—Å–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `storage/logs/laravel.log`:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥
- ‚ö†Ô∏è –ü—Ä–æ–ø—É—Å–∫–∏ (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç)
- ‚ùå –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞:
```
[2024-01-15 10:00:00] local.INFO: üîç –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 'meat', —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 1: https://povar.ru/list/meat/
[2024-01-15 10:00:01] local.INFO: ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1: –Ω–∞–π–¥–µ–Ω–æ 30 —Ä–µ—Ü–µ–ø—Ç–æ–≤
[2024-01-15 10:00:01] local.INFO: üìä –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1: –∏–∑ 30 —Ä–µ—Ü–µ–ø—Ç–æ–≤, –Ω–æ–≤—ã—Ö: 25
[2024-01-15 10:00:01] local.INFO: ‚úÖ –°–æ–±—Ä–∞–Ω–æ –Ω–æ–≤—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤: 25/30
```

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–æ–≤

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# 1. –°–æ–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ URL
php artisan recipes:collect-urls salad --count=5

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
php test-parser.php

# 3. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å—é –æ—á–µ—Ä–µ–¥—å
php artisan recipes:process-queue
```

### –ß—Ç–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å

‚úÖ **–°–±–æ—Ä URL**: –ü–∞—Ä—Å–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ—Ü–µ–ø—Ç—ã –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π  
‚úÖ **–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞**: –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ `<h1 itemprop="name">`  
‚úÖ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: –°–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `storage/app/public/recipes/`  
‚úÖ **–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã**: –ú–∞—Å—Å–∏–≤ —Å name, quantity, measure  
‚úÖ **–®–∞–≥–∏ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è**: –ú–∞—Å—Å–∏–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ —Ñ–æ—Ç–æ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞  
‚úÖ **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è  
‚úÖ **–ú–µ—Ç–∞-—Ç–µ–≥–∏**: SEO-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (title, description, keywords)  
‚úÖ **–†–µ–π—Ç–∏–Ω–≥**: –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ schema.org —Ä–∞–∑–º–µ—Ç–∫–∏  

---

## ‚ú® –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ —Å Povar.ru –≤–º–µ—Å—Ç–æ 1000.menu!
