# üåê –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü —Å Infinite Scroll

## –ü—Ä–æ–±–ª–µ–º–∞

–°–∞–π—Ç `1000.menu/cooking/all-new` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–±–µ—Å–∫–æ–Ω–µ—á–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É (infinite scroll)**:
- –†–µ—Ü–µ–ø—Ç—ã –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–Ω–∏–∑
- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —á–µ—Ä–µ–∑ `?page=X` **–ù–ï –†–ê–ë–û–¢–ê–ï–¢**
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–∫—Ä—ã—Ç—å `?page=69` –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## –†–µ—à–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å `InfiniteScrollBrowserParserService`, –∫–æ—Ç–æ—Ä—ã–π:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **Headless Browser** (Symfony Panther + Chrome)
- –≠–º—É–ª–∏—Ä—É–µ—Ç —Å–∫—Ä–æ–ª–ª–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–Ω–∏–∑
- –ñ–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞
- –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ—Ü–µ–ø—Ç—ã

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Chrome Driver

### Windows (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Chrome Driver —á–µ—Ä–µ–∑ Composer
composer require dbrekelmans/bdi
vendor/bin/bdi detect drivers
```

### Linux (–Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Google Chrome
wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
sudo dpkg -i google-chrome-stable_current_amd64.deb
sudo apt-get install -f

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ChromeDriver
wget https://chromedriver.storage.googleapis.com/LATEST_RELEASE
latest=$(cat LATEST_RELEASE)
wget "https://chromedriver.storage.googleapis.com/${latest}/chromedriver_linux64.zip"
unzip chromedriver_linux64.zip
sudo mv chromedriver /usr/local/bin/
sudo chmod +x /usr/local/bin/chromedriver
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –°–±–æ—Ä URL —Ä–µ—Ü–µ–ø—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º headless –±—Ä–∞—É–∑–µ—Ä–∞
php artisan recipes:collect-urls --count=100 --use-browser
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--count=100` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤ –¥–ª—è —Å–±–æ—Ä–∞
- `--use-browser` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å infinite scroll

## ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è Chrome –≤ headless —Ä–µ–∂–∏–º–µ**
   ```php
   $client = Client::createChromeClient(null, [
       '--headless',
       '--disable-gpu',
       '--no-sandbox'
   ]);
   ```

2. **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**
   ```php
   $client->request('GET', 'https://1000.menu/cooking/all-new');
   sleep(3); // –ñ–¥–µ–º –ø–µ—Ä–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É
   ```

3. **–°–∫—Ä–æ–ª–ª–∏–Ω–≥ –≤–Ω–∏–∑**
   ```php
   for ($i = 0; $i < $scrolls; $i++) {
       $client->executeScript('window.scrollTo(0, document.body.scrollHeight);');
       sleep(2); // –ñ–¥–µ–º –ø–æ–¥–≥—Ä—É–∑–∫–∏ –Ω–æ–≤—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤
       // –°–æ–±–∏—Ä–∞–µ–º –Ω–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏
   }
   ```

4. **–°–±–æ—Ä —Å—Å—ã–ª–æ–∫**
   - –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —Å—Å—ã–ª–∫–∏ `/cooking/–ß–ò–°–õ–û`
   - –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
   - –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–µ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ –ë–î

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **1 —Å–∫—Ä–æ–ª–ª** ‚âà 20 –Ω–æ–≤—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤
- **–î–ª—è 100 —Ä–µ—Ü–µ–ø—Ç–æ–≤** –Ω—É–∂–Ω–æ ~7-10 —Å–∫—Ä–æ–ª–ª–æ–≤
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: ~30-60 —Å–µ–∫—É–Ω–¥

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **Chrome Driver –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. **–ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** —á–µ–º –æ–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥
3. **–ë–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä** (–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä)
4. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–¥–ª—è –Ω–æ–≤—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤**

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ CRON

–û–±–Ω–æ–≤–∏—Ç–µ cron –∑–∞–¥–∞—á—É –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞:

```bash
# –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç - —Å–±–æ—Ä URL —Å –±—Ä–∞—É–∑–µ—Ä–æ–º
*/15 * * * * cd /path/to/project && php artisan recipes:collect-urls --count=100 --use-browser >> /dev/null 2>&1

# –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏
*/30 * * * * cd /path/to/project && php artisan recipes:process-queue --batch=10 >> /dev/null 2>&1
```

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "Chrome driver not found"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
which chromedriver
which google-chrome

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
composer require dbrekelmans/bdi
vendor/bin/bdi detect drivers
```

### –û—à–∏–±–∫–∞: "Could not start browser"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
sudo chmod +x /usr/local/bin/chromedriver
sudo chmod +x /usr/bin/google-chrome
```

### –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –Ω–æ —Ä–µ—Ü–µ–ø—Ç—ã –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è

- –£–≤–µ–ª–∏—á—å—Ç–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è `sleep(3)` ‚Üí `sleep(5)`
- –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫—Ä–æ–ª–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä —Å—Å—ã–ª–æ–∫ –≤ –∫–æ–¥–µ

## üìù –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

–ï—Å–ª–∏ headless –±—Ä–∞—É–∑–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ:

1. **–ù–∞–π—Ç–∏ API endpoint** –¥–ª—è –ø–æ–¥–≥—Ä—É–∑–∫–∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π JavaScript
3. **–ü–∞—Ä—Å–∏—Ç—å RSS feed** –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
4. **–ú–µ–Ω—è—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –æ–±—ã—á–Ω–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
